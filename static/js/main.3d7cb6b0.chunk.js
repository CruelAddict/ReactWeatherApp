(this.webpackJsonpuntitled1=this.webpackJsonpuntitled1||[]).push([[0],{20:function(e,t,a){e.exports=a(31)},30:function(e,t,a){},31:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(11),c=a.n(i),o=a(2),s=a(3),l=a(5),u=a(4),m=a(6),d=a(1),h=a(12),p=a(7),v={CREATE_FAVORITE:"CREATE_FAVORITE",DELETE_FAVORITE:"DELETE_FAVORITE",SET_GEOLOCATION:"SET_GEOLOCATION"},f=function(e){return{type:v.CREATE_FAVORITE,payload:e}},E=function(e){return{type:v.DELETE_FAVORITE,payload:e}},b=function(e){return function(t){return t({type:v.SET_GEOLOCATION,payload:e}),Promise.resolve()}},O=v,y=function(e){return r.a.createElement("div",{className:"favorites-header-container"},r.a.createElement("div",{className:"favorites-title-container"},r.a.createElement("h2",null,"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435")),r.a.createElement("form",{className:"new-favorite-form",onSubmit:e.handleSubmit},r.a.createElement("input",{placeholder:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0433\u043e\u0440\u043e\u0434",className:"add-favorite-input",value:e.state.favoritesInput,onChange:e.handleChange}),r.a.createElement("button",{className:"favorites-action-button"},"+")))},g="bf3565940c52aaa3383c1dbc23799bb1",w=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).weatherByNameUrl=function(){return"http://api.openweathermap.org/data/2.5/weather?q=".concat(e.props.city,"&appid=").concat(e.state.api_key)},e.weatherByCoordinatesUrl=function(){return"http://api.openweathermap.org/data/2.5/weather?lat=".concat(z.getState().geo.coordinates.latitude,"&lon=").concat(z.getState().geo.coordinates.longitude,"&appid=").concat(e.state.api_key)},e.state={isLoading:!0,api_key:g},e.getWeather=e.getWeather.bind(Object(d.a)(e)),e.weatherByNameUrl=e.weatherByNameUrl.bind(Object(d.a)(e)),e.weatherByCoordinatesUrl=e.weatherByCoordinatesUrl.bind(Object(d.a)(e)),e.execWeatherRequest=e.execWeatherRequest.bind(Object(d.a)(e)),e.parseWeatherData=e.parseWeatherData.bind(Object(d.a)(e)),e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.getWeather()}},{key:"execWeatherRequest",value:function(e){var t=this,a=new XMLHttpRequest;a.open("GET",e),a.send(),a.onreadystatechange=function(e){if(4===a.readyState)if(a.responseText)if(200===a.status){var n=JSON.parse(a.responseText);t.parseWeatherData(n)}else t.raiseError("City not found.");else t.raiseError("Failed to connect to the server.")}}},{key:"parseWeatherData",value:function(e){var t=this,a=e.main.temp-273.15,n=e.wind.speed,r=e.main.humidity,i=e.main.pressure,c={longitude:e.coord.lon,latitude:e.coord.lat},o=e.name,s=e.weather[0].description,l=e.weather[0].icon;fetch("http://openweathermap.org/img/wn/".concat(l,"@2x.png"),{method:"GET"}).then((function(e){return e.blob()})).then((function(e){var l=(window.URL||window.webkitURL).createObjectURL(e);t.setState({isLoading:!1,city:o,coordinates:c,weather_data:{temperature:a,wind:n,humidity:r,pressure:i,cloudiness:s,icon:l}})}))}},{key:"getWeather",value:function(){this.setState({isLoading:!0});var e=this.weatherByCoordinatesUrl();this.execWeatherRequest(e)}},{key:"raiseError",value:function(e){console.log(e)}}]),t}(n.Component),j=function(e){return r.a.createElement("div",{className:"weather-value-list"},r.a.createElement("div",{className:"weather-value-row"},r.a.createElement("span",{className:"weather-value-key"},"\u0412\u0435\u0442\u0435\u0440"),r.a.createElement("span",{className:"weather-value-value"},e.state.weather_data.wind," m/s")),r.a.createElement("div",{className:"weather-value-row"},r.a.createElement("span",{className:"weather-value-key"},"\u041e\u0431\u043b\u0430\u0447\u043d\u043e\u0441\u0442\u044c"),r.a.createElement("span",{className:"weather-value-value"},e.state.weather_data.cloudiness.split(" ").map((function(e){return e.charAt(0).toUpperCase()+e.substring(1)})).join(" "))),r.a.createElement("div",{className:"weather-value-row"},r.a.createElement("span",{className:"weather-value-key"},"\u0414\u0430\u0432\u043b\u0435\u043d\u0438\u0435"),r.a.createElement("span",{className:"weather-value-value"},e.state.weather_data.pressure," hpa")),r.a.createElement("div",{className:"weather-value-row"},r.a.createElement("span",{className:"weather-value-key"},"\u0412\u043b\u0430\u0436\u043d\u043e\u0441\u0442\u044c"),r.a.createElement("span",{className:"weather-value-value"},e.state.weather_data.humidity," %")),r.a.createElement("div",{className:"weather-value-row"},r.a.createElement("span",{className:"weather-value-key"},"\u041a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u044b"),r.a.createElement("span",{className:"weather-value-value"},"[",e.state.coordinates.longitude.toFixed(2),", ",e.state.coordinates.latitude.toFixed(2),"]")))},N=function(e){return e.state.isLoading?r.a.createElement("div",{className:"side-weather-panel-container"},r.a.createElement("div",{className:"side-weather-panel-main-data"},r.a.createElement("div",{className:"side-city-name-container"},r.a.createElement("h2",null,e.state.city)),r.a.createElement("div",{className:"side-temperature-container"}),r.a.createElement("div",{className:"side-icon-cell"},r.a.createElement("div",null)),r.a.createElement("div",{className:"delete-favorite-button-container"},r.a.createElement("button",{onClick:e.handleFavoriteRemoval,className:"delete-favorite favorites-action-button"},"\xd7"))),r.a.createElement("div",{className:"loading-side"},r.a.createElement("h4",{className:"loading-title-side"},"\u041f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435, \u0434\u0430\u043d\u043d\u044b\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u044e\u0442\u0441\u044f"),r.a.createElement("div",{className:"spinner-container"},r.a.createElement("i",{className:"fa fa-refresh fa-spin fa-4x"})))):r.a.createElement("div",{className:"side-weather-panel-container"},r.a.createElement("div",{className:"side-weather-panel-main-data"},r.a.createElement("div",{className:"side-city-name-container"},r.a.createElement("h2",null,e.state.city)),r.a.createElement("div",{className:"side-temperature-container"},r.a.createElement("span",null,e.state.weather_data.temperature.toFixed(0),"\xb0\u0421")),r.a.createElement("div",{className:"side-icon-cell"},r.a.createElement("div",{className:"side-icon-container"},r.a.createElement("img",{src:e.state.weather_data.icon,alt:"weather icon"}))),r.a.createElement("div",{className:"delete-favorite-button-container"},r.a.createElement("button",{onClick:e.handleFavoriteRemoval,className:"delete-favorite favorites-action-button"},"\xd7"))),r.a.createElement("div",{className:"side-weather-items"},r.a.createElement(j,{state:e.state})))};function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var R=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).handleFavoriteRemoval=e.handleFavoriteRemoval.bind(Object(d.a)(e)),e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"getWeather",value:function(){var e=this.weatherByNameUrl();this.execWeatherRequest(e)}},{key:"handleFavoriteRemoval",value:function(){this.props.deleteFavorite(this.props.favoriteId)}},{key:"render",value:function(){return r.a.createElement(N,{state:this.state,handleFavoriteRemoval:this.handleFavoriteRemoval})}}]),t}(w),C=Object(p.b)((function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e)}),(function(e){return{deleteFavorite:function(t){return e(E(t))}}}))(R),S=Object(p.b)((function(e){return{items:e.favorites.items}}))((function(e){return r.a.createElement("div",{className:"favorites-container"},e.items.map((function(e){return r.a.createElement(C,{city:e.name,key:e.id,favoriteId:e.id})})))})),T=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(S,null)}}]),t}(r.a.Component);function F(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var L=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).handleSubmit=e.handleSubmit.bind(Object(d.a)(e)),e.handleChange=e.handleChange.bind(Object(d.a)(e)),e.state={favoritesInput:""},e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"handleSubmit",value:function(e){this.props.createFavorite(this.state.favoritesInput),e.preventDefault()}},{key:"handleChange",value:function(e){this.setState({favoritesInput:e.target.value})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(y,{handleSubmit:this.handleSubmit,handleChange:this.handleChange,state:this.state}),r.a.createElement(T,null))}}]),t}(n.Component),_=Object(p.b)((function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?F(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):F(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e)}),(function(e){return{createFavorite:function(t){return e(f(t))}}}))(L),I=function(e){return e.state.isLoading?r.a.createElement("div",{className:"loading-main"},r.a.createElement("h4",{className:"loading-title-main"},"\u041f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435, \u0434\u0430\u043d\u043d\u044b\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u044e\u0442\u0441\u044f"),r.a.createElement("div",{className:"spinner-container"},r.a.createElement("i",{className:"fa fa-refresh fa-spin fa-4x"}))):r.a.createElement("div",{className:"main-weather-panel-container"},r.a.createElement("div",{className:"main-weather-panel-main-data"},r.a.createElement("div",{className:"main-city-name-container"},r.a.createElement("h2",null,e.state.city)),r.a.createElement("div",{className:"icon-cell"},r.a.createElement("div",{className:"icon-container"},r.a.createElement("img",{src:e.state.weather_data.icon,alt:"weather icon"}))),r.a.createElement("div",{className:"temperature-container"},r.a.createElement("span",null,e.state.weather_data.temperature.toFixed(0),"\xb0\u0421"))),r.a.createElement(j,{state:e.state}))},D=function(e){return r.a.createElement("div",{id:"app-header"},r.a.createElement("div",{className:"header-text-container"},r.a.createElement("h1",{className:"header-text"},"\u041f\u043e\u0433\u043e\u0434\u0430 \u0437\u0434\u0435\u0441\u044c")),r.a.createElement("div",{className:"button-container"},r.a.createElement("button",{onClick:e.refreshGeo,className:"geo-refresh-button"},"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0433\u0435\u043e\u043b\u043e\u043a\u0430\u0446\u0438\u044e")))},G={latitude:51.507351,longitude:-.127758},P=function(e){return navigator.geolocation?navigator.geolocation.getCurrentPosition((function(t){z.dispatch(b({permissionGranted:!0,coordinates:{latitude:t.coords.latitude,longitude:t.coords.longitude}})).then(e)}),(function(){z.dispatch(b({permissionGranted:!1,coordinates:G})).then(e)})):console.log("Not supported"),Promise.resolve()},x=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).refreshGeo=e.refreshGeo.bind(Object(d.a)(e)),e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"refreshGeo",value:function(){P(this.props.mainLocationRefresh)}},{key:"render",value:function(){return r.a.createElement(D,{refreshGeo:this.refreshGeo})}}]),t}(n.Component),A=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).mainLocationRefresh=e.mainLocationRefresh.bind(Object(d.a)(e)),e}return Object(m.a)(t,e),Object(s.a)(t,[{key:"mainLocationRefresh",value:function(){this.setState({isLoading:!0}),this.getWeather()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(x,{mainLocationRefresh:this.mainLocationRefresh}),r.a.createElement(I,{state:this.state}))}}]),t}(w),W=Object(p.b)((function(e){return{geo:e.geo}}))(A),U=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this))).state={coordinates:e.coordinates},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){P()}},{key:"render",value:function(){return null===this.props.permissionGranted?null:r.a.createElement("div",{id:"app"},r.a.createElement(W,{coordinates:this.props.coordinates}),r.a.createElement(_,null))}}]),t}(r.a.Component),B=Object(p.b)((function(e){return{permissionGranted:e.geo.permissionGranted,coordinates:e.geo.coordinates}}))(U),V=a(9),q=a(18),J=a(19),M=Object(V.c)({favorites:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{items:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O.CREATE_FAVORITE:return{items:[].concat(Object(J.a)(e.items),[{id:0===e.items.length?0:e.items[e.items.length-1].id+1,name:t.payload}])};case O.DELETE_FAVORITE:return{items:e.items.filter((function(e,a,n){return e.id!==t.payload}))};default:return e}},geo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{permissionGranted:null,coordinates:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O.SET_GEOLOCATION:return t.payload;default:return e}}}),H={favorites:{items:localStorage.getItem("favorites")?JSON.parse(localStorage.getItem("favorites")):[]},geo:{permissionGranted:null,coordinates:null}},X=(a(30),Object(V.d)(M,H,Object(V.a)(q.a)));X.subscribe((function(){localStorage.setItem("favorites",JSON.stringify(X.getState().favorites.items))})),c.a.render(r.a.createElement(p.a,{store:X},r.a.createElement(B,null)),document.getElementById("root"));var z=t.default=X}},[[20,1,2]]]);
//# sourceMappingURL=main.3d7cb6b0.chunk.js.map